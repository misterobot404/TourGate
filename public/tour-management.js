(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{209:function(t,e,r){"use strict";var o=r(13);function a(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,o)}return r}function i(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?a(Object(r),!0).forEach((function(e){n(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function n(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var s={name:"Breadcrumbs",computed:i(i({},Object(o.e)("tours",["breadcrumbs"])),{},{sectionNotRoot:function(){return this.$route.params.id}})},l=r(16),c=r(17),u=r.n(c),d=r(260),p=r(216),b=r(43),v=r(42),f=Object(l.a)(s,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-card",{directives:[{name:"show",rawName:"v-show",value:t.sectionNotRoot,expression:"sectionNotRoot"}],staticStyle:{background:"rgba(30,30,30, 0.4)"},attrs:{flat:"",dark:""}},[r("v-breadcrumbs",{staticClass:"mb-4",attrs:{large:"",items:t.breadcrumbs},scopedSlots:t._u([{key:"item",fn:function(e){var o=e.item;return[r("v-breadcrumbs-item",{staticStyle:{cursor:"pointer"},style:{textShadow:o.href===t.$route.fullPath?"0px 0px 4px rgba(255,255,255,0.3)":"none"},on:{click:function(e){t.$route.fullPath===o.href?t.$router.go(0):t.$router.push(o.href)}}},[t._v("\n                "+t._s(o.text.toUpperCase())+"\n            ")])]}},{key:"divider",fn:function(){return[r("v-icon",[t._v("chevron_right")])]},proxy:!0}])})],1)}),[],!1,null,null,null);e.a=f.exports;u()(f,{VBreadcrumbs:d.a,VBreadcrumbsItem:p.a,VCard:b.a,VIcon:v.a})},256:function(t,e,r){"use strict";r.r(e);var o=r(13),a=r(209);function i(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,o)}return r}function n(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?i(Object(r),!0).forEach((function(e){s(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function s(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var l={name:"CreateDialog",props:{dialogType:String,showCreateDialog:Boolean},data:function(){return{valid:null,loading:!1,tour:{}}},computed:{tour_parent_id:function(){return void 0===this.$route.params.id?null:this.$route.params.id}},methods:n(n({},Object(o.b)("tours",{createTourAction:"createTour"})),{},{createTour:function(){var t=this,e=new FormData;e.append("parent_id",this.tour_parent_id),e.append("title",this.tour.title),e.append("description",this.tour.description),e.append("image",this.tour.image),"Tour"===this.dialogType?e.append("isSection","false"):e.append("isSection","true"),"Tour"===this.dialogType&&e.append("source_url",this.tour.source_url),this.loading=!0,this.createTourAction(e).then((function(){t.loading=!1,t.$emit("update:showCreateDialog",!1),t.clear()}))},clear:function(){this.tour={}}})},c=r(16),u=r(17),d=r.n(u),p=r(48),b=r(43),v=r(25),f=r(196),g=r(201),h=r(203),m=r(188),y=r(252),_=r(198),T=r(42),O=r(199),w=r(200),C=r(184),D=r(253),j=r(47),x=r(37),V=Object(c.a)(l,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-dialog",{attrs:{value:t.showCreateDialog,"max-width":"540","overlay-opacity":"0.2"},on:{input:function(e){return t.$emit("update:showCreateDialog",e)}}},[r("v-card",[r("v-toolbar",{staticClass:"pr-1",attrs:{height:"68",flat:""}},[r("v-icon",{staticClass:"mr-3",attrs:{"x-large":""}},[t._v("\n                tour\n            ")]),t._v(" "),r("v-toolbar-title",[t._v(" Создание "),"Tour"===t.dialogType?r("span",[t._v("тура")]):r("span",[t._v("категории")])])],1),t._v(" "),r("v-divider"),t._v(" "),r("v-card-text",{staticClass:"pb-0"},[r("v-form",{ref:"form",model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[r("v-container",{staticClass:"pb-0"},[r("v-row",[r("v-col",{staticClass:"pb-0 pt-3",attrs:{cols:"12"}},[r("v-text-field",{attrs:{label:"Название",filled:"",rules:[function(t){return!!t||"Введите название"}],required:""},model:{value:t.tour.title,callback:function(e){t.$set(t.tour,"title","string"==typeof e?e.trim():e)},expression:"tour.title"}})],1),t._v(" "),r("v-col",{staticClass:"pb-0 pt-1",attrs:{cols:"12"}},[r("v-file-input",{attrs:{label:"Медиа",filled:"",accept:"image/*","prepend-icon":"add_a_photo",rules:[function(t){return!!t||"Выберите картинку"}],required:""},model:{value:t.tour.image,callback:function(e){t.$set(t.tour,"image",e)},expression:"tour.image"}})],1),t._v(" "),r("v-col",{staticClass:"pb-0 pt-1",attrs:{cols:"12"}},[r("v-textarea",{attrs:{filled:"",label:"Описание","auto-grow":"",rules:[function(t){return!!t||"Введите описание"}],required:""},model:{value:t.tour.description,callback:function(e){t.$set(t.tour,"description","string"==typeof e?e.trim():e)},expression:"tour.description"}})],1),t._v(" "),"Tour"===t.dialogType?r("v-col",{staticClass:"pb-0 pt-1",attrs:{cols:"12"}},[r("v-text-field",{attrs:{label:"Ссылка на источник",filled:"",rules:[function(t){return!!t||"Введите ссылку на источник"}],required:""},model:{value:t.tour.source_url,callback:function(e){t.$set(t.tour,"source_url","string"==typeof e?e.trim():e)},expression:"tour.source_url"}})],1):t._e()],1)],1)],1)],1),t._v(" "),r("v-card-actions",{staticClass:"px-9 pb-4"},[r("v-spacer"),t._v(" "),r("v-btn",{staticClass:"px-7",attrs:{rounded:"",depressed:""},on:{click:t.clear}},[t._v("\n                Очистить\n            ")]),t._v(" "),r("v-btn",{staticClass:"px-7",attrs:{rounded:"",depressed:"",loading:t.loading,disabled:!t.valid},on:{click:t.createTour}},[t._v("\n                Подтвердить\n            ")])],1)],1)],1)}),[],!1,null,null,null),P=V.exports;d()(V,{VBtn:p.a,VCard:b.a,VCardActions:v.a,VCardText:v.b,VCol:f.a,VContainer:g.a,VDialog:h.a,VDivider:m.a,VFileInput:y.a,VForm:_.a,VIcon:T.a,VRow:O.a,VSpacer:w.a,VTextField:C.a,VTextarea:D.a,VToolbar:j.a,VToolbarTitle:x.a});function k(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,o)}return r}function E(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?k(Object(r),!0).forEach((function(e){S(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):k(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function S(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var $={name:"EditDialog",props:{showEditDialog:Boolean},data:function(){return{valid:null,loading:!1,editableTour:null}},computed:E({},Object(o.e)("tours",["tours","editableTourId"])),watch:{editableTourId:{immediate:!0,handler:"getEditableTourClone"}},methods:E(E({},Object(o.b)("tours",{updateTourAction:"updateTour"})),{},{getEditableTourClone:function(){var t=this;this.editableTour=Object.assign({},this.tours.find((function(e){return e.id===t.editableTourId})))},updateTour:function(){var t=this,e=new FormData;e.append("title",this.editableTour.title),e.append("description",this.editableTour.description),e.append("image",this.editableTour.image),this.editableTour.isSection||e.append("source_url",this.editableTour.source_url);var r={tourId:this.editableTour.id,tour:e};this.loading=!0,this.updateTourAction(r).then((function(){t.loading=!1,t.$emit("update:showEditDialog",!1)}))}})},I=Object(c.a)($,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-dialog",{attrs:{value:t.showEditDialog,"max-width":"540","overlay-opacity":"0.2"},on:{input:function(e){return t.$emit("update:showEditDialog",e)}}},[r("v-card",[r("v-toolbar",{staticClass:"pr-1",attrs:{height:"68",flat:""}},[r("v-icon",{staticClass:"mr-3",attrs:{"x-large":""}},[t._v("\n                edit\n            ")]),t._v(" "),r("v-toolbar-title",[t._v(" Редактирование "),t.editableTour.isSection?r("span",[t._v("категории")]):r("span",[t._v("тура")])])],1),t._v(" "),r("v-divider"),t._v(" "),r("v-card-text",{staticClass:"pb-0"},[r("v-form",{ref:"form",model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[r("v-container",{staticClass:"pb-0"},[r("v-row",[r("v-col",{staticClass:"pb-0 pt-3",attrs:{cols:"12"}},[r("v-text-field",{attrs:{label:"Название",filled:"",rules:[function(t){return!!t||"Введите название"}],required:""},model:{value:t.editableTour.title,callback:function(e){t.$set(t.editableTour,"title","string"==typeof e?e.trim():e)},expression:"editableTour.title"}})],1),t._v(" "),r("v-col",{staticClass:"pb-0 pt-1",attrs:{cols:"12"}},[r("v-file-input",{attrs:{label:"Медиа",filled:"",accept:"image/*","prepend-icon":"add_a_photo",required:""},model:{value:t.editableTour.image,callback:function(e){t.$set(t.editableTour,"image",e)},expression:"editableTour.image"}})],1),t._v(" "),r("v-col",{staticClass:"pb-0 pt-1",attrs:{cols:"12"}},[r("v-textarea",{attrs:{filled:"",label:"Описание","auto-grow":"",rules:[function(t){return!!t||"Введите описание"}],required:""},model:{value:t.editableTour.description,callback:function(e){t.$set(t.editableTour,"description","string"==typeof e?e.trim():e)},expression:"editableTour.description"}})],1),t._v(" "),t.editableTour.isSection?t._e():r("v-col",{staticClass:"pb-0 pt-1",attrs:{cols:"12"}},[r("v-text-field",{attrs:{label:"Ссылка на источник",filled:"",rules:[function(t){return!!t||"Введите ссылку на источник"}],required:""},model:{value:t.editableTour.source_url,callback:function(e){t.$set(t.editableTour,"source_url","string"==typeof e?e.trim():e)},expression:"editableTour.source_url"}})],1)],1)],1)],1)],1),t._v(" "),r("v-card-actions",{staticClass:"px-9 pb-4"},[r("v-spacer"),t._v(" "),r("v-btn",{staticClass:"px-7",attrs:{rounded:"",depressed:""},on:{click:t.getEditableTourClone}},[t._v("\n                Сброс\n            ")]),t._v(" "),r("v-btn",{staticClass:"px-7",attrs:{rounded:"",depressed:"",loading:t.loading,disabled:!t.valid},on:{click:t.updateTour}},[t._v("\n                Подтвердить\n            ")])],1)],1)],1)}),[],!1,null,null,null),B=I.exports;function A(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,o)}return r}function F(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?A(Object(r),!0).forEach((function(e){L(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):A(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function L(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}d()(I,{VBtn:p.a,VCard:b.a,VCardActions:v.a,VCardText:v.b,VCol:f.a,VContainer:g.a,VDialog:h.a,VDivider:m.a,VFileInput:y.a,VForm:_.a,VIcon:T.a,VRow:O.a,VSpacer:w.a,VTextField:C.a,VTextarea:D.a,VToolbar:j.a,VToolbarTitle:x.a});var R={name:"TourManagement",components:{BreadcrumbsNavigation:a.a,CreateDialog:P,EditDialog:B},data:function(){return{firstLoading:!0,editDialog:!1,createDialog:!1,createDialogType:"Tour",destroyTourLoading:!1}},computed:F({},Object(o.e)("tours",["tours","editableTourId"])),methods:F(F(F({},Object(o.b)("tours",{getTours:"getTours",destroyTourAction:"destroyTour"})),Object(o.d)("tours",["SET_EDITABLE_TOUR_ID"])),{},{cardClickBehavior:function(t){t.isSection?this.$router.push({name:"TourManagement",params:{id:t.id}}):window.open(t.source_url)},showEditDialog:function(t){this.SET_EDITABLE_TOUR_ID(t),this.editDialog=!0},showCreateDialog:function(t){this.createDialogType=t,this.createDialog=!0},destroyTour:function(t){var e=this;this.destroyTourLoading=!0,this.destroyTourAction(t).then((function(){e.destroyTourLoading=!1}))}}),created:function(){var t=this;this.getTours(this.$route.params.id).then((function(){t.firstLoading=!1}))},beforeRouteUpdate:function(t,e,r){this.getTours(t.params.id).then((function(){r()}))}},q=r(38),N=r(254),U=r(80),z=r(46),J=Object(c.a)(R,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("div",{staticClass:"mb-4"},[r("v-btn",{staticClass:"mr-2",attrs:{rounded:""},on:{click:function(e){return t.showCreateDialog("Section")}}},[t._v("\n            Добавить категорию\n        ")]),t._v(" "),r("v-btn",{attrs:{rounded:""},on:{click:function(e){return t.showCreateDialog("Tour")}}},[t._v("\n            Добавить тур\n        ")])],1),t._v(" "),t.firstLoading?t._e():r("BreadcrumbsNavigation"),t._v(" "),r("v-row",{staticClass:"mb-6",attrs:{dense:""}},t._l(t.tours,(function(e,o){return r("v-col",{key:e.title,staticClass:"text-center",attrs:{cols:t.$vuetify.breakpoint.xs?12:o%3?6:12}},[r("v-hover",{scopedSlots:t._u([{key:"default",fn:function(o){var a=o.hover;return[r("v-card",{staticClass:"overflow-hidden",staticStyle:{cursor:"pointer"},on:{click:function(r){return t.cardClickBehavior(e)}}},[r("v-img",{staticClass:"white--text align-end",attrs:{transition:"scale-transition",origin:"center center",height:"320px",src:e.image_url,alt:e.title,gradient:"to bottom, rgba(0,0,0,.1), rgba(0,0,0,.5)"}},[r("v-fade-transition",[a?t._e():r("v-card-title",{staticClass:"display-1",domProps:{textContent:t._s(e.title)}})],1)],1),t._v(" "),r("v-fade-transition",{attrs:{group:""}},[a?r("v-btn",{key:"delete",staticStyle:{top:"10px",right:"10px","z-index":"6"},attrs:{loading:t.destroyTourLoading,fab:"",absolute:"",dark:"",top:"",right:""},on:{click:function(r){return r.stopPropagation(),t.destroyTour(e.id)}}},[r("v-icon",[t._v("delete")])],1):t._e(),t._v(" "),a?r("v-btn",{key:"edit",staticStyle:{top:"10px",right:"70px","z-index":"6"},attrs:{fab:"",absolute:"",dark:"",top:"",right:""},on:{click:function(r){return r.stopPropagation(),t.showEditDialog(e.id)}}},[r("v-icon",[t._v("edit")])],1):t._e(),t._v(" "),a?r("v-overlay",{key:"overlay",staticClass:"px-8",attrs:{absolute:"",color:"#036358"}},[r("span",{staticClass:"title mx-auto",staticStyle:{"white-space":"pre-wrap"},domProps:{textContent:t._s(e.description)}})]):t._e()],1)],1)]}}],null,!0)})],1)})),1),t._v(" "),r("CreateDialog",{attrs:{showCreateDialog:t.createDialog,dialogType:t.createDialogType},on:{"update:showCreateDialog":function(e){t.createDialog=e},"update:show-create-dialog":function(e){t.createDialog=e}}}),t._v(" "),null!==t.editableTourId?r("EditDialog",{attrs:{showEditDialog:t.editDialog},on:{"update:showEditDialog":function(e){t.editDialog=e},"update:show-edit-dialog":function(e){t.editDialog=e}}}):t._e()],1)}),[],!1,null,null,null);e.default=J.exports;d()(J,{VBtn:p.a,VCard:b.a,VCardTitle:v.c,VCol:f.a,VFadeTransition:q.c,VHover:N.a,VIcon:T.a,VImg:U.a,VOverlay:z.a,VRow:O.a})}}]);